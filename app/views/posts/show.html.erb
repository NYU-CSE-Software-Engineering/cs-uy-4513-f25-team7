<div data-test-id="post-show">
  <div class="card mb-4">
    <div class="card-body">
      <h1 class="card-title">
        <%= @post.title %>
        <% if @post.post_type == 'Meta' %>
          <span class="badge bg-info text-dark" data-test-id="post-badge-meta">Meta</span>
        <% else %>
          <span class="badge bg-secondary"><%= @post.post_type %></span>
        <% end %>
      </h1>
      <p class="text-muted">Posted by <%= @post.user.email %> on <%= @post.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
      <hr>
      <div class="card-text">
        <%= simple_format(@post.body) %>
      </div>
    </div>
  </div>

  <h3>Comments</h3>
  <div id="comments">
    <% @comments.each do |comment| %>
      <div class="card mb-2">
        <div class="card-body py-2">
          <p class="mb-1"><%= comment.body %></p>
          <small class="text-muted">
            - <%= comment.user.email %> at <%= comment.created_at.strftime("%I:%M %p") %>
            <% if current_user == comment.user %>
              <%= link_to 'Delete', post_comment_path(@post, comment), data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' }, class: 'text-danger ms-2' %>
            <% end %>
          </small>
        </div>
      </div>
    <% end %>
  </div>

  <% if user_signed_in? %>
    <div class="mt-4">
      <h4>Add a comment</h4>
      <%= render 'comments/form', post: @post, comment: @comment %>
    </div>
  <% else %>
    <p class="mt-4 text-muted">Please <%= link_to 'sign in', new_user_session_path %> to comment.</p>
  <% end %>

  <%= link_to 'Back to Forum', posts_path, class: 'btn btn-secondary mt-3' %>
</div>
